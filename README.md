# ðŸ—ï¸ Architecture Overview

ì´ í”„ë¡œì íŠ¸ëŠ” ì´ˆê¸° ê°œë°œ ìƒì‚°ì„±ê³¼ ìž¥ê¸°ì ì¸ í™•ìž¥ì„±(MSA ì „í™˜)ì„ ë™ì‹œì— ê³ ë ¤í•˜ì—¬

ë‹¤ìŒê³¼ ê°™ì€ ì•„í‚¤í…ì²˜ ê²°ì •ì„ ê¸°ë°˜ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.

> Modular Monolith + DDD Layered Architecture + CQRS + Event-Driven
> 
> 
> (Hexagonal Architectureì˜ ì¼ë¶€ ì›ì¹™ì„ ì„ íƒì ìœ¼ë¡œ ì°¨ìš©)
> 

---

## ðŸ“Œ ì„¤ê³„ ëª©í‘œ

- ì´ˆê¸°ì—ëŠ” **ëª¨ë†€ë¦¬ì‹ìœ¼ë¡œ ë¹ ë¥´ê²Œ ê°œë°œ**
- ë„ë©”ì¸ ê°„ ê²°í•©ì„ ìµœì†Œí™”í•˜ì—¬ **ë‚˜ì¤‘ì— MSAë¡œ ë¶„ë¦¬ ê°€ëŠ¥**
- ë³µìž¡í•œ ì¡°íšŒ ìš”êµ¬ì‚¬í•­ì„ ë„ë©”ì¸ ëª¨ë¸ì—ì„œ ë¶„ë¦¬
- â€œì™œ ì´ëŸ° êµ¬ì¡°ë¥¼ ì„ íƒí–ˆëŠ”ì§€â€ë¥¼ ëª…í™•ížˆ ì„¤ëª…í•  ìˆ˜ ìžˆëŠ” ì„¤ê³„

---

## ðŸ§© Modular Monolith

í”„ë¡œì íŠ¸ëŠ” **ë„ë©”ì¸ ë‹¨ìœ„ë¡œ ëª…í™•ížˆ ë¶„ë¦¬ëœ ëª¨ë“ˆí˜• ëª¨ë†€ë¦¬ì‹** êµ¬ì¡°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

```
post
social
user
```

- ê° ëª¨ë“ˆì€ **ë¯¸ëž˜ì˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê²½ê³„**ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.
- í˜„ìž¬ëŠ” ë‹¨ì¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ì§€ë§Œ,
    
    í–¥í›„ ì„œë¹„ìŠ¤ ë¶„ë¦¬ ì‹œ **ëª¨ë“ˆ ë‹¨ìœ„ë¡œ ì´ë™ë§Œ í•˜ë©´ ë˜ë„ë¡** ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.
    

---

## ðŸ§± Layered Architecture (ëª¨ë“ˆ ë‚´ë¶€)

ê° ë„ë©”ì¸ ëª¨ë“ˆ ë‚´ë¶€ëŠ” ë‹¤ìŒê³¼ ê°™ì€ **ì „í†µì ì¸ ë ˆì´ì–´ë“œ êµ¬ì¡°**ë¥¼ ë”°ë¦…ë‹ˆë‹¤.

```
presentation
application
domain
infrastructure
```

### ê° ë ˆì´ì–´ì˜ ì±…ìž„

- **presentation**
    - HTTP API
    - Request / Response DTO
    - ì¸ì¦Â·ì¸ê°€ ì²˜ë¦¬
- **application**
    - ìœ ìŠ¤ì¼€ì´ìŠ¤ ì‹¤í–‰
    - íŠ¸ëžœìž­ì…˜ ê²½ê³„
    - ë„ë©”ì¸ ê°ì²´ ì¡°í•©
- **domain**
    - ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì˜ ì¤‘ì‹¬
    - Aggregate Root / Entity
- **infrastructure**
    - JPA, QueryDSL, ë©”ì‹œì§• ë“± ê¸°ìˆ  êµ¬í˜„

---

## ðŸ“¦ Domain-Driven Design (DDD)

### Aggregate ì¤‘ì‹¬ ì„¤ê³„

ë„ë©”ì¸ ëª¨ë¸ì€ **Aggregate ë‹¨ìœ„ë¡œ ëª…í™•ížˆ ê²½ê³„ë¥¼ ì„¤ì •**í–ˆìŠµë‹ˆë‹¤.

ì˜ˆì‹œ (Post ë„ë©”ì¸):

- `Post` : Aggregate Root
- `PostPlace` : Post ë‚´ë¶€ Entity
- PlaceëŠ” Post ì—†ì´ ë‹¨ë…ìœ¼ë¡œ ì¡´ìž¬í•  ìˆ˜ ì—†ìŒ

```
Post
 â””â”€ PostPlace (ë‚´ë¶€ Entity)
```

### ë„ë©”ì¸ ì„¤ê³„ ì›ì¹™

- Aggregate ì™¸ë¶€ ê°ì²´ëŠ” **IDë¡œë§Œ ì°¸ì¡°**
- Aggregate ë‚´ë¶€ë§Œ ê°ì²´ ì—°ê´€ê´€ê³„ í—ˆìš©
- ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì€ **Entity ë‚´ë¶€ì— ìœ„ì¹˜**
- ì¡°íšŒ ìš”êµ¬ì‚¬í•­ì€ Domainì— í¬í•¨í•˜ì§€ ì•ŠìŒ

---

## ðŸ”€ CQRS (Command / Query Responsibility Segregation)

ì¡°íšŒ ìš”êµ¬ì‚¬í•­ì´ ë³µìž¡í•´ì§ì— ë”°ë¼ **ì“°ê¸°(Command)ì™€ ì½ê¸°(Query)ë¥¼ ë¶„ë¦¬**í–ˆìŠµë‹ˆë‹¤.

### Command Side

- ë„ë©”ì¸ ê·œì¹™ê³¼ ì •í•©ì„±ì— ì§‘ì¤‘
- Aggregate ê¸°ë°˜ ì²˜ë¦¬
- íŠ¸ëžœìž­ì…˜ ê²½ê³„ ëª…í™•

### Query Side

- DTO / Projection ê¸°ë°˜ ì¡°íšŒ
- QueryDSL / Native SQL ì‚¬ìš©
- í™”ë©´ ìš”êµ¬ì‚¬í•­ì— ë§žì¶˜ ìžìœ ë¡œìš´ ì¡°íšŒ

```
application.command  â†’ ë„ë©”ì¸ ê·œì¹™
application.query    â†’ ì¡°íšŒ ìµœì í™”
```

ì´ë¥¼ í†µí•´ **ë„ë©”ì¸ ëª¨ë¸ì´ ì¡°íšŒ ìš”êµ¬ì‚¬í•­ì— ì˜¤ì—¼ë˜ì§€ ì•Šë„ë¡** í–ˆìŠµë‹ˆë‹¤.

---

## ðŸ“£ Event-Driven Architecture

ë„ë©”ì¸ ê°„ ì§ì ‘ ì˜ì¡´ì„ ì œê±°í•˜ê¸° ìœ„í•´ **ì´ë²¤íŠ¸ ê¸°ë°˜ í†µì‹ **ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

- ë„ë©”ì¸ ê°„ ì§ì ‘ í˜¸ì¶œ âŒ
- ëª¨ë“  ìƒí˜¸ìž‘ìš©ì€ ì´ë²¤íŠ¸ë¥¼ í†µí•´ ì „ë‹¬
- ì´ë²¤íŠ¸ëŠ” **íŠ¸ëžœìž­ì…˜ ì»¤ë°‹ ì´í›„(AFTER_COMMIT)** ë°œí–‰

### ì´ë²¤íŠ¸ íë¦„ ì˜ˆì‹œ

```
Post ìƒì„±
 â†’ PostCreatedEvent ë°œí–‰
 â†’ ë‹¤ë¥¸ ë„ë©”ì¸ì—ì„œ ì´ë²¤íŠ¸ ìˆ˜ì‹  í›„ ì²˜ë¦¬
```

ì´ êµ¬ì¡°ëŠ” í–¥í›„ Kafka, SQS ë“± **ë©”ì‹œì§€ ë¸Œë¡œì»¤ë¡œ ìžì—°ìŠ¤ëŸ½ê²Œ í™•ìž¥**í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

---

## ðŸ”Œ Hexagonal Architecture â€“ ì„ íƒì  ì°¨ìš©

ì´ í”„ë¡œì íŠ¸ëŠ” **ìˆœìˆ˜í•œ Hexagonal ArchitectureëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**

ëŒ€ì‹ , **êµì²´ ê°€ëŠ¥ì„±ì´ ë†’ì€ ì§€ì ì—ë§Œ Port ê°œë…ì„ ì„ íƒì ìœ¼ë¡œ ë„ìž…**í–ˆìŠµë‹ˆë‹¤.

### Portë¥¼ ì‚¬ìš©í•˜ëŠ” ì˜ì—­

- `PostRepository` (ì €ìž¥ì†Œ)
- `EventPublisher` (ì´ë²¤íŠ¸ ë°œí–‰)

```
application
 â””â”€ port
     â””â”€ out
         â””â”€ PostRepository
```

### Portë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì˜ì—­

- QueryRepository (ì¡°íšŒ ì „ìš©)
- ë‹¨ìˆœ ìœ í‹¸ / í—¬í¼

> ê³¼ë„í•œ ì¶”ìƒí™”ë¥¼ í”¼í•˜ë©´ì„œë„
> **MSA ì „í™˜ ì‹œ ìˆ˜ì • ë¹„ìš©ì„ ìµœì†Œí™”í•˜ê¸° ìœ„í•´ì„œ**ìž…ë‹ˆë‹¤.
>
